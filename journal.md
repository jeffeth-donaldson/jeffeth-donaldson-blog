# Jeffeth Donaldson's blog - Dev journal

## 1/4/24

I started my project today. I decided to go with strapi as my cms. I like that it can be hosted by myself. To download it, I followed their guide here: [https://docs.strapi.io/dev-docs/quick-start](https://docs.strapi.io/dev-docs/quick-start). I needed to downgrade my node.js installation to get it to work. To do that I used [nvm](https://github.com/nvm-sh/nvm/tree/master). nvm was pretty simple to install and very intuitive to use, just `nvm install --lts` and I was off to the races. Then I was able to install strapi with yarn and start a quickstart project. I created my admin account using the portal (not sure if that is local or if I've now got some account in the cloud somewhere.) I can't do much else because I need to cook dinner. toodles.

addendum: after dinner I was feeling extra productive so I played around with the UI in strapi and created my first model. (blog post). Now I need to see how I go about hosting it.

## 1/6/24

I tested the api generated by strapi today. I have created a collection in Insomnium for that express purpose. To use the API I had to create an API key, I did that and saved it in `api.token` in the jeffeth-donaldson-blog dir. Here's the [api reference](https://docs.strapi.io/dev-docs/api/rest#api-parameters) for later. *NOTE:* make sure you are using the 'plural' api Id (so just add an 's' to the end).

I also added an `about` single content type. This is where I put my about-me stuff. I'll be able to pull it into an about-me page as well as the bottom of any blog posts I write. I've decided to use svelte for my frontend. I'm going to try using sveltekit. THe difference between svelte and sveltekit is that sveltekit comes with a router. I've never used it before, but luckily there is a [guide from strapi](https://strapi.io/blog/how-to-create-a-blog-with-svelte-kit-strapi) that talks about integrating the two. 

I went ahead and started on that guide just enough to create the sveltekit demo app.

Something Else I researched today was hosting. I think I'll use my always-free tier vm on oracle cloud. I want to do this all official-like so I want to have a proper domain name as well as a ssl certificate so I can do https. I found a [guide](https://blogs.oracle.com/developers/post/free-ssl-certificates-in-the-oracle-cloud-using-certbot-and-lets-encrypt) that talks about how I can set up a certificate to auto renew.

What's left for me to do on the overall roadmap is:
1. determine what program I'll use to host my app (Node? Apache?)
2. figure out how I'm going to get a domain name

## 1/7/24

Unfortunately for me, that strapi tutorial is very old, so the svelte stuff is quite outdated. I'll still be able to use it to interface with strapi (kind of) but for svelte, I'm kind of on my own. So I rebuilt the svelte part from scratch, and started on a very basic skeleton. I think my goal for next time will be to get a skeleton for displaying a blog post working. From there I can spend all the time in the world styling! (not fun)

## 1/13/24

Today I started working on getting my page view working. As I'm getting started though I start asking myself some questions, like "how am I going to connect my frontend to the backend?" There appear to be a few ways I could do it. I think since I'm going to be taking advantage of sveltekit, I should probably use serverside rendering and treat strapi like it's a database. Although, I feel like I actual want to use strapi like a web api because that's really how it should be used. But I' think I'm still going to do serverside rendering because that makes sense for my app

I also learned about [pm2](https://github.com/Unitech/pm2/), a process manager that will make keeping both my sveltekit project and my strapi project running in parallel.

Okay, so after working some more I made some good progress. I was able to add in my api token to a src/lib/server/secrets.ts file. This is really neat beacuse it will only resolve if I try ti import it into server code, it's completely safe from leaking to the client. This also means I can use localhost to resolve the backend, if I wanted to I could make it so that it isn't even accessible by the internet. That kind of defeats the purpose, but maybe I will haha. 

After I got that working I was able to add a page.server.ts to my posts/\[slug\] path (the brackets allow variable path names). THis means that the server will retrieve the post information and then send it to the client.

THat was great and all, but the json payload we get back from strapi is quite dense. I'd like to be able to autocomplete it with types (you know, the whole point of TS???) However, they don't have a builtin way of doing that?? very strange to me. However, this is a workaround that works pretty good. I followed this guide [here](https://strapi.io/blog/improve-your-frontend-experience-with-strapi-types-and-type-script) Ignore all the stuff about setting up and just follow the steps below. Essentially, Strapi will generate types to be used internally and we can copy those types and bring them over to our frontend. with the use of some clever filtering we can get rid of all the strapi specific metadata and just get our sweet sweet types. Now all I have to do when I change the schema is just run my little script `yarn run copytypes` and blamo, I get updated usable types in the frontend.

Now my next challenge will be writing a rich text renderer. My article body is rich text, which translates to a somewhat complicated json object. I can potentially find someone else's and just use it, but I hope it won't be too difficult for me to just write. THat would make a good article at least!

## 1/16/24

Today I started on the rich text renderer. I got the image, paragraph, and @apply in sveltekitheading tags done. I just have to do list and code.

## 1/18/24

Today I finished the rich text renderer. At least, the most basic version of it. It was pretty simple but now I have to do the hard part of styling it. I was originally planning on using tailwind css here, but that might not work great for me. If I can figure out how to use the @apply syntax in my code (see PostBody.svelte) then it might work. But if I can't figure it out next Time I'm going to have to remove tailwind and just do it the old fashioned way.

## 1/20/24

Today I got started on styling. I made a bunch of progress, but I've hit a snag. I need to get something that can highlight code snippets for me, but right now I don't have anything that can do that. I think i'll have to use [https://highlightjs.org/](https://highlightjs.org/) if I don't want to have to redo any work. But I do have a lot of the styling for the blog post done. I also need to handle the background image as well as images in the post that are too large and need to be sized down.

## 1/22/24

Well, I have struck out on the whole code highlighting thing. So what I'm going to have to do is transpose my javascript function into a pure svelte component. There are definitely some nasty things about it, like declaring a bunch of variables of which most are useless. But aside from that, it will allow me to use the svelte component code highlighter. The reason it wasn't working was because my svelte component's css was taking precedence over the highlighter's css. Also, it wasn't sanitizing my inputs so it was seeing my elements inside \<pre\> elements as actual html.

## 1/27/24

Haha! I have done it, I have rewritten my big function that made the html in sveltese. It honestly wasn't that bad. I'm not really missing out on too much. There were some weird bugs at the end with minor syntax issues, but I've got it working. I'm starting to see that svelte really needs a bit more maturity that react.js has. It'll get there eventually though. THat's all I really have time for today so I'll see you guys in the next one. Oh, it's important to **NOT** import svelte components in the `{}` for some reason. IDK why, but it won't work otherwise.

## 1/30/24

Today I continued work on the code block.
I wanted to add a "copy to clipboard" button and work on the styling a bit. I think I've got it where I like it now, it will change style from light to dark mode and I have a little button. I just need to now make it say that the code was copied when you click on it and I think I'm good. 

Next up is working on the site header I think.

## 2/3/24

Today I worked on the cover image for the blog post as well as tweaked the copy code button. The cover image has this nice gradient into the title of the article. Something odd is that image urls sometimes have the name of the strapi server in them, but other times do not. So I need to be able to dynamically add that if need be. To do so, I created a constants.ts file in a client dir in the lib dir. I also added some types for images since they are pretty complex objects. Oh! also, apparently images aren't included by default in api requests, you need to add `populate=*` to the query params to get everything. Honestly, kind of annoying but whatever.

## 2/6/24

Today I did a bit of styling on the header, and then realized it is kind of pointless to work on it until I finish some more pages. So I started work on the posts page. I created a search bar and then also got the serverside typescript for getting the list of posts. I'll have to add sorting and searching later. I also started using fontawesome for my icons. They look nice and will be quick to  get set up on my page. You just add a script to your page's header and you are off to the races. 

## 2/10/24

Today I did work on the post thumbnail which is what I'm calling what appears in the all posts page. I still need to make it link to the actual post, but so far it shows all the content I'd want it to. I also need to work on querying my posts. I think I'll use query params to do it. Searching by tag will be interesting. we'll see how that goes. Nothing too exciting to say.

## 2/11/24

Today I made it so that you can click on posts thumbnails and it will take you to the article. I also added last updated fields on the thumbnail and the article itself.

## 2/13/24

Today I got to work on the search functionality of my app. I made a lot of progress. I have the serverside code set up to pass a query to strapi depending on query parameters I provide in the page. By default I just check to see if the title, slug, or body match in any way with my search query. it's pretty loose. I still need to handle searching with tags, and pagination. I have the places to plug in to implement both of those, I just need to add the ui parts to it. I'm thinking I just make it so if you click on a tag anywhere it navigates to the search with that tag. A tricky point was that the page wouldn't reload, but thanks to this documentation I was able to get something figured out: [https://kit.svelte.dev/docs/form-actions](https://kit.svelte.dev/docs/form-actions) All you need to do is add this attribute to your form: `data-sveltekit-reload`.

## 2/15/24

Today I worked on upgrading the search. I first made it so that the search page will show what you searched for in a little box with an x on it. That way when the page reloads you will remember what you searched for. I also added the ability to search for tags. If you click on a tag, it will show you only posts that also have that tag. I made it an element so it can work from a post as well! I ran into some issues persisting the search params between searches. For the search form I had to add an invisible element that gets populated automatically with what tags you had. I also ran into an issue querying the tags. Repeatable elements in STRAPI can't be queried taking the whole array into account it seems. I'd have to check each element in the array to see if it matched. This wasn't going to work for me because I don't know how many elements are in the array. So I just decided to get rid of it and use a comma separated string. I can probably add some verification to make sure I don't accidentally screw that up. I'll do that tomorrow. I also need to make it so the tags show up on the article page. Once I do that I am good to start working on the home page as well as the projects page!

## 2/17/24

Today I made it so tags show up inside the post page, and I also added the paginator to the search page. It's all really slick and how I like it. One thing that I wasn't sure about was how to design the paginator. I don't know if there is a best practice or not. And having looked online I couldn't really find any sort of definitive answer. So what I did is that if you are past the first page, on the left you'll have a link to the previous page, a link that is a left arrow that takes you to the previous page, and a double left arrow that takes you to the first page. If you aren't on the last page we have the same thing mirrored on the other side. It also displays what page you are on now in a different color (this isn't a link). It is a bit redundant like I said but also it seemed to be the most natural to me so it's what I went with. 

## 2/20/24

Today I went hog-wild on my home page. I have some really cool CSS effects I'm really proud of. My title block has an animated background and a really cool font, and I have a links row with animated colors and a cool expanding hover animation. I'm also adding in some quick links to recent posts and a section for recent projects once I've implemented those. I'm thinking I need to work on sprucing up my header as well. Oh and I need to work on a footer too.

## 2/27/24

It's been a while since I've last added stuff to the project because I got strep last week. I still have it but I'm feeling much better. Anyways I added in a footer and I spiced up the header a bit. I added a website label to the header, and added some animation to the background. Now that cool breathing effect will be on all of my pages so it is a bit more thematically consistent. I added a link to my github and a "made with 😎" message at the bottom. Next time I'll add the "about me" page 

## 3/9/24

Today I worked on the about me page. I had a hard time getting it to space correctly, but I think I've got something working now. I don't really like how I did it. I had to do a spacer and make it's height some amount of vh. I don't know how it will look once I get real info in there. The page is essentially static so that shouldn't be too much of a problem. I also noticed that my header doesn't work that great when we are on mobile screen sizes. I think I need to make the site logo disappear if the screen isn't wide enough. I'm not sure how I'd do that. Aside from that I need to work on the projects backend next time.

## 3/11/24

Today I added some the backend schema for projects and started on the frontend. Since it is very similar to posts I'm reusing a lot of stuff.

## 3/19/24

Today I fixed a few bugs with the project search page. I also made the decision to have all tags link to the posts page. I feel like that will make more sense since I won't be having too many projects. I started on the project view page as well today. It is basically going to be a card with some information on it as well as some links to articles about the project. I'm reusing the post page so I got a lot for free. It still needs more work though. The articles don't show up yet.

## 3/21/24

Today I added the related articles view to the project page. I had lots of issues dealing with the overflow and sizing. I've also realized that I am not equipped for this to work on mobile. I think I need to get that working first since I bet lots of people will try to visit the site on their phones. An easier thing to do would be to be able to link back from an article to the project it is a part of.

## 3/26/24

Today I finished the desktop site! Hooray! Except I forgot to have the article link back to the project is belongs to. oops. Well next time I can take care of that. I also started working on getting the mobile site working. I got the header, the main page, and I'm partway through the article search. Making your site reactive is really quite easy. There is a `@media screen and (max-width: 800px)` selector that you can use to change the css depending on the width. 800px is a pretty generous number for phone screens so I should be good. Next time I'll continue in my conversion.

## 3/28/24

Today I was feeling a bit sick so I didn't work too much on the site. I did have articles (very lazily) link back to the project they are a part of. I also finished the mobile site views for the posts and projects pages. I realize now I should have made those pages mostly a component, but I didn't oh well. Next time I can work on the About Me page if I want an easy job, or I can work on the posts/project page if I want a hard job.