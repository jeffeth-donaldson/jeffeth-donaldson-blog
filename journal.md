# Jeffeth Donaldson's blog - Dev journal

## 1/4/24

I started my project today. I decided to go with strapi as my cms. I like that it can be hosted by myself. To download it, I followed their guide here: [https://docs.strapi.io/dev-docs/quick-start](https://docs.strapi.io/dev-docs/quick-start). I needed to downgrade my node.js installation to get it to work. To do that I used [nvm](https://github.com/nvm-sh/nvm/tree/master). nvm was pretty simple to install and very intuitive to use, just `nvm install --lts` and I was off to the races. Then I was able to install strapi with yarn and start a quickstart project. I created my admin account using the portal (not sure if that is local or if I've now got some account in the cloud somewhere.) I can't do much else because I need to cook dinner. toodles.

addendum: after dinner I was feeling extra productive so I played around with the UI in strapi and created my first model. (blog post). Now I need to see how I go about hosting it.

## 1/6/24

I tested the api generated by strapi today. I have created a collection in Insomnium for that express purpose. To use the API I had to create an API key, I did that and saved it in `api.token` in the jeffeth-donaldson-blog dir. Here's the [api reference](https://docs.strapi.io/dev-docs/api/rest#api-parameters) for later. *NOTE:* make sure you are using the 'plural' api Id (so just add an 's' to the end).

I also added an `about` single content type. This is where I put my about-me stuff. I'll be able to pull it into an about-me page as well as the bottom of any blog posts I write. I've decided to use svelte for my frontend. I'm going to try using sveltekit. THe difference between svelte and sveltekit is that sveltekit comes with a router. I've never used it before, but luckily there is a [guide from strapi](https://strapi.io/blog/how-to-create-a-blog-with-svelte-kit-strapi) that talks about integrating the two. 

I went ahead and started on that guide just enough to create the sveltekit demo app.

Something Else I researched today was hosting. I think I'll use my always-free tier vm on oracle cloud. I want to do this all official-like so I want to have a proper domain name as well as a ssl certificate so I can do https. I found a [guide](https://blogs.oracle.com/developers/post/free-ssl-certificates-in-the-oracle-cloud-using-certbot-and-lets-encrypt) that talks about how I can set up a certificate to auto renew.

What's left for me to do on the overall roadmap is:
1. determine what program I'll use to host my app (Node? Apache?)
2. figure out how I'm going to get a domain name

## 1/7/24

Unfortunately for me, that strapi tutorial is very old, so the svelte stuff is quite outdated. I'll still be able to use it to interface with strapi (kind of) but for svelte, I'm kind of on my own. So I rebuilt the svelte part from scratch, and started on a very basic skeleton. I think my goal for next time will be to get a skeleton for displaying a blog post working. From there I can spend all the time in the world styling! (not fun)

## 1/13/24

Today I started working on getting my page view working. As I'm getting started though I start asking myself some questions, like "how am I going to connect my frontend to the backend?" There appear to be a few ways I could do it. I think since I'm going to be taking advantage of sveltekit, I should probably use serverside rendering and treat strapi like it's a database. Although, I feel like I actual want to use strapi like a web api because that's really how it should be used. But I' think I'm still going to do serverside rendering because that makes sense for my app

I also learned about [pm2](https://github.com/Unitech/pm2/), a process manager that will make keeping both my sveltekit project and my strapi project running in parallel.

Okay, so after working some more I made some good progress. I was able to add in my api token to a src/lib/server/secrets.ts file. This is really neat beacuse it will only resolve if I try ti import it into server code, it's completely safe from leaking to the client. This also means I can use localhost to resolve the backend, if I wanted to I could make it so that it isn't even accessible by the internet. That kind of defeats the purpose, but maybe I will haha. 

After I got that working I was able to add a page.server.ts to my posts/\[slug\] path (the brackets allow variable path names). THis means that the server will retrieve the post information and then send it to the client.

THat was great and all, but the json payload we get back from strapi is quite dense. I'd like to be able to autocomplete it with types (you know, the whole point of TS???) However, they don't have a builtin way of doing that?? very strange to me. However, this is a workaround that works pretty good. I followed this guide [here](https://strapi.io/blog/improve-your-frontend-experience-with-strapi-types-and-type-script) Ignore all the stuff about setting up and just follow the steps below. Essentially, Strapi will generate types to be used internally and we can copy those types and bring them over to our frontend. with the use of some clever filtering we can get rid of all the strapi specific metadata and just get our sweet sweet types. Now all I have to do when I change the schema is just run my little script `yarn run copytypes` and blamo, I get updated usable types in the frontend.

Now my next challenge will be writing a rich text renderer. My article body is rich text, which translates to a somewhat complicated json object. I can potentially find someone else's and just use it, but I hope it won't be too difficult for me to just write. THat would make a good article at least!

## 1/16/24

Today I started on the rich text renderer. I got the image, paragraph, and @apply in sveltekitheading tags done. I just have to do list and code.

## 1/18/24

Today I finished the rich text renderer. At least, the most basic version of it. It was pretty simple but now I have to do the hard part of styling it. I was originally planning on using tailwind css here, but that might not work great for me. If I can figure out how to use the @apply syntax in my code (see PostBody.svelte) then it might work. But if I can't figure it out next Time I'm going to have to remove tailwind and just do it the old fashioned way.

## 1/20/24

Today I got started on styling. I made a bunch of progress, but I've hit a snag. I need to get something that can highlight code snippets for me, but right now I don't have anything that can do that. I think i'll have to use [https://highlightjs.org/](https://highlightjs.org/) if I don't want to have to redo any work. But I do have a lot of the styling for the blog post done. I also need to handle the background image as well as images in the post that are too large and need to be sized down.

## 1/22/24

Well, I have struck out on the whole code highlighting thing. So what I'm going to have to do is transpose my javascript function into a pure svelte component. There are definitely some nasty things about it, like declaring a bunch of variables of which most are useless. But aside from that, it will allow me to use the svelte component code highlighter. The reason it wasn't working was because my svelte component's css was taking precedence over the highlighter's css. Also, it wasn't sanitizing my inputs so it was seeing my elements inside \<pre\> elements as actual html.